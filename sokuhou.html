<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>緊急放屁速報</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      background: black;
      color: red;
      font-family: 'Courier New', monospace;
      text-align: center;
      padding: 40px;
      animation: blinkBg 1s infinite alternate;
    }

    h1 {
      font-size: 3em;
      margin-bottom: 20px;
      animation: flashText 0.5s infinite alternate;
    }

    @keyframes blinkBg {
      0% { background: black; }
      100% { background: darkred; }
    }

    @keyframes flashText {
      0% { color: red; }
      100% { color: yellow; }
    }

    #message {
      font-size: 1.5em;
      margin-top: 30px;
      white-space: pre-wrap;
    }
     #popup {
    position: fixed;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    background: yellow;
    border: 4px solid red;
    width: 90%;
    max-width: 500px;
    font-family: 'Courier New', monospace;
    font-size: 1.1em;
    box-shadow: 0 0 20px red;
    z-index: 9999;
    animation: shake 0.5s infinite alternate;
  }

  .popup-header {
    background: red;
    color: white;
    padding: 8px;
    font-weight: bold;
    text-align: center;
  }

  .popup-body {
    padding: 12px;
    background: #fff700;
    color: black;
    min-height: 60px;
    white-space: pre-wrap;
  }

  @keyframes shake {
    0% { transform: translateX(-50%) translateY(0px); }
    100% { transform: translateX(-50%) translateY(-3px); }
  }
  </style>
  <div id="popup">
  <div class="popup-header">❘ 緊急放屁速報（異臭庁） ❘</div>
  <div class="popup-body" id="popup-text">情報取得中…</div>
</div>
</head>
<body>
  <h1>🚨 緊急放屁速報 🚨</h1>
  <div id="message">強い臭いに警戒してください。</div>

  <!-- 音声再生 -->
  <audio id="alert" src="assets/alert_loop.wav" autoplay loop></audio>
  <audio id="announce" src="assets/fart_announcement.wav"></audio>

 <script>
  const alert = document.getElementById("alert");
  const announce = document.getElementById("announce");
  const message = document.getElementById("message");

  // まず保存されたデータを読み取る
  const fartData = JSON.parse(localStorage.getItem("fartData")) || {
    time: "不明",
    db: "???",
    magnitude: "???"
  };

  const generatedMessage = `
${fartData.time}ごろ、和室で強い放屁がありました。
震源地は和室のピと推定されています。
最大臭度${fartData.db}、屁グニチュードは${fartData.magnitude}と観測されています。
繰り返します――
最大臭度${fartData.db}、屁グニチュードは${fartData.magnitude}と観測されています。
和室内にいるとゲボえの恐れがあります。今すぐ逃げてください！
  `;
   const popupText = document.getElementById("popup-text");
popupText.textContent = `
${fartData.time} 和室で放屁が観測されました。
最大臭度 ${fartData.db} ／ 屁グニチュード ${fartData.magnitude}
室内にいる方はただちに換気してください。
`;


  // テロップ差し替え＆音声再生切り替え
  setTimeout(() => {
    alert.pause();
    announce.play();
    message.textContent = generatedMessage;
  }, 8000);
</script>

</body>
</html>
